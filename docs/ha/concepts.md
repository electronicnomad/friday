# 기본 개념과 용어들

## heartbeat

클러스터에 참여하는 노드 사이에는 레이턴시(latency)가 낮은 네트워크가 구성됩니다.
이 네트워크를 통하여 참여 노드 사이에 일정한 신호를 약속된 간격으로 주고 받음으로써
상대 노드가 정상 작동이 가능한지에 대한 확인을 합니다. 이 방식을 heartbeat이라고 하고
사용되는 네트워크가 heartbeat network이라고 합니다.
heartbeat network은 2개의 노드로 구성될 경우, P2P로 구성되기도 합니다.

## quorum

영단어 '정족수'를 뜻 하는 그 단어입니다.
영자 신문 정치면에서나 가끔 볼 수 있는 이 단어가
HA 클러스터에서 사용되는 것이 눈에 띌 것입니다.
quorum은 HA 클러스터에서 해당 클러스터를 유지하는 판단 기준을 마련해 줍니다.
이 이야기를 제대로 전달하기 위해서는 다음의 개념에 대한 이해가 필요합니다.

### HA 클러스터는 (결국) 데이터 서비스

결국 HA 클러스터를 구성하고 운영하는 목적은 서비스의 가용성을 최대화
하는 데에 있다고 할 수 있습니다. 그리고 HA 클러스터를 유지하는 목적은
아무래도 '데이터'를 서비스하기 위함일 것입니다.
그래서, HA 클러스터는 데이터를 보호하기 위해 다양한 장치를 마련하게 됩니다.

HA 클러스터에 참여하는 개별 노드등이 서로 적절한 교신을 하지 못 하게 되는 상황에서
하나의 데이터에 각자 아무런 조정없이 접근해서 데이터를 변경하려 한다면
이는 심각한 문제가 되기 때문입니다.

### 살아 있어요

HA 클러스터가 유지되는 조건은 참여 노드의 1/2 이상이 살아 있을 때 가능하다는 조건이 일반적입니다.
만약, 2 노드 구성이면 하나의 노드에 문제가 생기면 바로 해당 클러스터는 불신되게 됩니다. 운영할 수가 없습니다.

### voting

## split brain

## amnesia

## racing conditions

## dependency

## fencing

## NTP

## SPOF

Single Point Of Failure의 약어입니다. HA 클러스터를 구성할 때 이 SPOF를 회피하려는 노력의 연속입니다.
예를 들어 노드A와 노드B의 heartbeat network을 위한 연결선이 하나, 즉 단선(單線)이다 - 라고 하면 이 선이
SPOF가 됩니다. SPOF를 회피하려는 의도는 아주 단순한 하나의 문제로 클러스터 전체의 안정성을 해치는
상황을 연출하는 건 바보 같은 일이 되기 때문입니다. 그래서 SPOF는 존재하면 안 되는 것입니다.
이를 지칭해서 '이중화' 등으로 우리나라에서는 말하는데, 시간이 지나다 보니, '이중화' = '고가용성'
이라는 식의 인식이 만들어져 있습니다. 그러나, '이중화'가 반드시 고가용성을 약속하는 것이 아닙니다.
하위 집합이라고 봐야 할 듯 합니다.
